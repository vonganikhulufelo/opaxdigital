  <div class="row">
    <div class="col-md-6">
        <div class="card-box">
            <h4 class="m-t-0 m-b-30 header-title"></h4>

            <%= form_with(model: customer, local: true) do |form| %>
                <div class="form-group row">
                    <label for="inputEmail3" class="col-3 col-form-label">Customer Name</label>
                    <div class="col-9">
                        <%= form.text_field :customer_name, class: "form-control", placeholder: "Enter Customer Name", id: "Customer_Name",required: :true%> </div>
                </div>
                <div class="form-group row">
                    <label for="inputPassword3" class="col-3 col-form-label">Customer Location</label>
                    <div class="col-9">
                        <%= form.text_field :location, class: "form-control", placeholder: "Enter Customer Location", id: "location"%> </div>
                </div>
                <div class="form-group row">
                    <label for="inputPassword5" class="col-3 col-form-label">Customer Address</label>
                    <div class="col-9">
                         <%= form.text_field :customer_address, class: "form-control", placeholder: "Enter Customer Address", id: "Customer_Address"%> </div>
                </div>
                <div class="form-group row">
                    <label for="inputPassword5" class="col-3 col-form-label">Customer Contact</label>
                    <div class="col-9">
                         <%= form.text_field :customer_contact, class: "form-control", placeholder: "Enter Customer Contact", id: "Customer_Contact"%></div>
                </div>
                <div class="form-group row">
                    <label for="inputPassword5" class="col-3 col-form-label">Customer Email</label>
                    <div class="col-9">
                        <%= form.text_field :customer_email, class: "form-control", placeholder: "Enter Customer Email", id: "Customer_Email"%>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="inputPassword5" class="col-3 col-form-label">Payment Term</label>
                    <div class="col-9">
                      <% if controller.action_name == "edit" %>
                        <%= select_tag "paymentterm_description", options_from_collection_for_select(PaymentTerm.all, "id", "paymentterm_description", CustomerPaymentTerm.where(customer_id: @customer.id).select(:payment_term_id).map(&:payment_term_id)),{multiple: true, include_blank: true, class: 'select2 select2-multiple', required: "required"} %>
                      <% else %>
                        <%= select_tag "paymentterm_description", options_from_collection_for_select(PaymentTerm.all , "id", "paymentterm_description"),{multiple: true, include_blank: true, class: 'form-control select2 select2-multiple', required: "required"} %>
                      <% end %>
                    </div>
                </div>
                  <%= form.hidden_field :user_id, value: current_user.user_id %>
                <div class="form-group mb-0 justify-content-end row">
                    <div class="col-9">
                        <button type="submit" class="btn btn-info waves-effect waves-light">Submit</button>
                       <a onclick="history.back(-1)" href="" class="btn btn-secondary waves-effect waves-light">Cancel</a>
                    </div>
                </div>
            <% end %>
        </div>
    </div>
    <div class="col-md-6">
         <div id="mapid" style="max-width: 600px; min-height: 400px;"></div>
    </div>

</div>

   <!-- Load Leaflet from CDN -->
   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
   integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
   crossorigin=""/>
   <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
   integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
   crossorigin=""></script>


   <!-- Load Esri Leaflet from CDN -->
   <script src="https://unpkg.com/esri-leaflet@2.2.4/dist/esri-leaflet.js"
   integrity="sha512-tyPum7h2h36X52O2gz+Pe8z/3l+Y9S1yEUscbVs5r5aEY5dFmP1WWRY/WLLElnFHa+k1JBQZSCDGwEAnm2IxAQ=="
   crossorigin=""></script>


 <!-- Load Esri Leaflet Geocoder from CDN -->
 <link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.2.14/dist/esri-leaflet-geocoder.css"
   integrity="sha512-v5YmWLm8KqAAmg5808pETiccEohtt8rPVMGQ1jA6jqkWVydV5Cuz3nJ9fQ7ittSxvuqsvI9RSGfVoKPaAJZ/AQ=="
   crossorigin="">
 <script src="https://unpkg.com/esri-leaflet-geocoder@2.2.14/dist/esri-leaflet-geocoder.js"
   integrity="sha512-uK5jVwR81KVTGe8KpJa1QIN4n60TsSV8+DPbL5wWlYQvb0/nYNgSOg9dZG6ViQhwx/gaMszuWllTemL+K+IXjg=="
   crossorigin=""></script>


<script>
var gMap = undefined;
var gGeocodeService = null;
var gAddressMarker = null;

function onTilesLoaded()
{
    //console.log( 'Tiles completely loaded ...');
    //$(".leaflet-control-zoom").css("visibility", "hidden");
}

function onGeocodeReverseComplete(error,result) {
    $("#Customer_Address").val( result.address.Match_addr );
    gAddressMarker.bindPopup(result.address.Match_addr).openPopup();
}

function onMapMarkerDragEnd(event){
    var marker = event.target;  
    var result = marker.getLatLng();  
    gGeocodeService.reverse().latlng(marker.getLatLng()).run( onGeocodeReverseComplete );
    gMap.panTo(new L.LatLng(result.lat, result.lng));
}

function onMapClicked(e) {
    if ( gAddressMarker !== null ) gMap.removeLayer( gAddressMarker );
    gGeocodeService.reverse().latlng(e.latlng).run( onGeocodeReverseComplete );
    gAddressMarker = L.marker(e.latlng,{draggable: true}).addTo(gMap);
    gAddressMarker.on('dragend', onMapMarkerDragEnd);
    gMap.flyTo(e.latlng, 13);
}

function initLeafLetMap() {
    gMap = L.map('mapid').on('load', onTilesLoaded).setView([-25.958044,28.038462], 8);

    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoidm9uZ2FuaS0xMjM0IiwiYSI6ImNqeHE0NXpsMDA0OWozY25leTlhNGhrNmIifQ.zROs7rjTRtiYVAqigrpdbA', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
            '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
            'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
        id: 'mapbox.streets'
    }).addTo(gMap);

    gGeocodeService =  L.esri.Geocoding.geocodeService();
  gMap.on('click', onMapClicked );


  var arcgisOnline = L.esri.Geocoding.arcgisOnlineProvider();

var searchControl = L.esri.Geocoding.geosearch({
  providers: [
    arcgisOnline,
    L.esri.Geocoding.mapServiceProvider({
      label: 'States and Counties',
      url: 'https://sampleserver6.arcgisonline.com/arcgis/rest/services/Census/MapServer',
      layers: [2, 3],
      searchFields: ['NAME', 'STATE_NAME']
    })
  ]
}).addTo(gMap);
}
        
     initLeafLetMap();


</script>